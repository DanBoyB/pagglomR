---
title: "Analysis of Agglomeration Impacts"
author: "`r scheme_name`"
date: "`r report_date`"
output:
  word_document:
    reference_docx: template.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(dplyr)
library(pagglomR)

# function to add euro symbol
euro_format <- function(x) {
  paste("\U20AC", scales::comma(x))
}

# source("/home/dan/R/projects/agglomeration/package/test.R")
```

**Scenario: `r scheme_scenario`**

\newline

**Opening Year: `r scheme_opening_year`**

## General Appraisal Input Parameters

```{r}
discount_rate <- c(0.04, 0.035, 0.03, 0.025, 0.02, 0.015)

gen_params <- c(
  "Scheme Opening Year", 
  "Discount Rate (Year 1-30)",
  "Discount Rate (Year 31-60)",
  "Discount Rate (Year 61-90)",
  "Assumed annual inflation rate (2020-2024)",
  "Assumed annual inflation rate (2025+)"
)

gen_values <- c(scheme_opening_year,
                scales::percent(discount_rate[1], accuracy = 0.1),
                scales::percent(discount_rate[2], accuracy = 0.1),
                scales::percent(discount_rate[3], accuracy = 0.1),
                scales::percent(0.022, accuracy = 0.1),
                scales::percent(0.023, accuracy = 0.1))

tibble(Parameter = gen_params,
       Value = gen_values) %>% 
  knitr::kable(format = "simple", align = 'll') 
```

## Agglomeration Calculation Input Parameters

```{r}
pagglomR::parameters %>% 
  mutate(across(c(2), euro_format)) %>% 
  knitr::kable(format = "simple",
                 col.names = c(
                   "Sector",
                   "GVA per person \U20AC",
                   "Distance decay parameter, \U221D",
                   "Elasticity of effective density to productivity, \U03C1"
                 ),
                 align = 'llll') 
```

## Summary of Agglomeration Impacts

\newline

```{r}
# convert numbers to euro currency format
summary_benefits_render <- benefits_summary %>% 
    mutate(across(where(is.numeric), euro_format))

# render as table using kable
summary_benefits_render %>% 
    knitr::kable(format = "simple",
                 col.names = c("Appraisal period", "Present Value Benefits"),
                 align = 'lll') 
```

\newline

**Total Agglomeration Benefits: `r paste("â‚¬", scales::comma(sum(benefits_summary$pv_benefits)))`**

\newline

## Table of Agglomeration Impacts

\newline

```{r}
# convert numbers to euro currency format
disc_benefits_render <- benefits_discounted %>% 
    mutate(across(c(2, 4, 5), euro_format)) %>% 
    select(-appraisal_year)

# render as table using kable
disc_benefits_render %>% 
    knitr::kable(format = "simple", 
                 col.names = c("Year", 
                           "Modelled Benefits", 
                           "Nominal Benefits", 
                           "Present Value Benefits (2011 prices)"),
                 align = 'lll') 
```

Analysis undertaken using `pagglomR()` package in `R` - version no. 
`r packageVersion("pagglomR")` developed and maintained by TII
